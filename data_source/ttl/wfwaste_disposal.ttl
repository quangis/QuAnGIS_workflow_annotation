# @Author(s): Eric Top, Simon Scheider, 
@prefix ccd: <http://geographicknowledge.de/vocab/CoreConceptData.rdf#> .
@prefix cct: <https://github.com/quangis/cct#> .
@prefix data: <https://github.com/quangis/cct/blob/master/tools/data.ttl#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix tools: <https://github.com/quangis/cct/blob/master/tools/tools.ttl#> .
@prefix wf: <http://geographicknowledge.de/vocab/Workflow.rdf#> .

data:n37 wf:applicationOf tools:wfwaste_disposal ;
    wf:input1 data:waterways ;
    wf:input2 data:afvalcontainers ;
    wf:input3 data:AEBfacility ;
    wf:output data:routes ;
    rdfs:comment "What is the travel time along waterways through the AEB incineration plant and every waste disposal place in Amsterdam?" .

data:n21 wf:applicationOf tools:CreateNetwork ;
    wf:input1 data:waterways ;
    wf:output data:waterways3 ;
    rdfs:comment "Builds ratio network from line objects" ;
    cct:expression "['    1: ObjectInfo(Nom);\\n    nbuild(\\n        join_attr\\n            (get_attrL 1)\\n            (apply1\\n                (compose size deify)\\n                (get_attrL 1)\\n            )\\n    )']" .

data:n28 wf:applicationOf tools:TSPRouting ;
    wf:input1 data:waterways3 ;
    wf:input2 data:afvalcontainers ;
    wf:input3 data:AEBfacility ;
    wf:output data:routes ;
    cct:expression "['1: Network(Ratio);\\n2: ObjectInfo(Nom);\\n3: ObjectInfo(Nom);        \\n           nRoutes (get_attrL 2) (get_attrL 3) 1']" .

tools:CreateNetwork a wf:Workflow ;
    wf:edge data:n0,
        data:n2 ;
    wf:source data:waterways ;
    dct:subject """    1: ObjectInfo(Nom);
    nbuild(
        join_attr
            (get_attrL 1)
            (apply1
                (compose size deify)
                (get_attrL 1)
            )
    )""" ;
    rdfs:comment "Builds ratio network from line objects" .

tools:TSPRouting a wf:Workflow ;
    wf:edge data:n11,
        data:n4,
        data:n7,
        data:n9 ;
    wf:source data:AEBfacility,
        data:afvalcontainers,
        data:waterways3 ;
    dct:subject """1: Network(Ratio);
2: ObjectInfo(Nom);
3: ObjectInfo(Nom);        
           nRoutes (get_attrL 2) (get_attrL 3) 1""" .

tools:wfwaste_disposal a wf:Workflow ;
    wf:edge data:n0,
        data:n11,
        data:n2,
        data:n21,
        data:n28,
        data:n4,
        data:n7,
        data:n9 ;
    wf:source data:AEBfacility,
        data:afvalcontainers,
        data:waterways ;
    rdfs:comment "What is the travel time along waterways through the AEB incineration plant and every waste disposal place in Amsterdam?" .

data:n0 wf:applicationOf tools:CreateNetworkDataset ;
    wf:input1 data:waterways ;
    wf:output data:waterways2 .

data:n11 wf:applicationOf tools:Solve ;
    wf:input1 data:waterways6 ;
    wf:output data:routes .

data:n2 wf:applicationOf tools:BuildNetwork ;
    wf:input1 data:waterways2 ;
    wf:output data:waterways3 .

data:n4 wf:applicationOf tools:MakeRouteAnalysisLayer ;
    wf:input1 data:waterways3 ;
    wf:output data:waterways4 .

data:n7 wf:applicationOf tools:AddLocations ;
    wf:input1 data:waterways4 ;
    wf:input2 data:afvalcontainers ;
    wf:output data:waterways5 .

data:n9 wf:applicationOf tools:AddLocations ;
    wf:input1 data:waterways5 ;
    wf:input2 data:AEBfacility ;
    wf:output data:waterways6 .

data:waterways2 a ccd:LineA,
        ccd:NetworkQ .

data:waterways4 a ccd:LineA,
        ccd:NetworkQ,
        ccd:RatioA .

data:waterways5 a ccd:LineA,
        ccd:NetworkQ,
        ccd:RatioA .

data:waterways6 a ccd:LineA,
        ccd:NetworkQ,
        ccd:RatioA .

data:AEBfacility a ccd:NominalA,
        ccd:ObjectQ,
        ccd:PointA ;
    rdfs:comment "Point location of waste facilityin Amsterdam" .

data:afvalcontainers a ccd:NominalA,
        ccd:ObjectQ,
        ccd:PointA ;
    rdfs:label "Waste containers" ;
    rdfs:comment "Point locations of waste containers in Amsterdam" .

data:waterways a ccd:LineA,
        ccd:NominalA,
        ccd:ObjectQ .

data:waterways3 a ccd:LineA,
        ccd:NetworkQ,
        ccd:RatioA .

